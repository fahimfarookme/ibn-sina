!function($){$.fn.autoComplete=function(options){var o=$.extend({},$.fn.autoComplete.defaults,options);return"string"==typeof options?(this.each(function(){var that=$(this);"destroy"==options&&($(window).off("resize.autocomplete",that.updateSC),that.off("blur.autocomplete focus.autocomplete keydown.autocomplete keyup.autocomplete"),that.data("autocomplete")?that.attr("autocomplete",that.data("autocomplete")):that.removeAttr("autocomplete"),$(that.data("sc")).remove(),that.removeData("sc").removeData("autocomplete"))}),this):this.each(function(){function suggest(data){var val=that.val();if(that.cache[val]=data,data.length&&val.length>=o.minChars){for(var s="",i=0;i<data.length;i++)s+=o.renderItem(data[i],val);that.sc.html(s),that.updateSC(0)}else that.sc.hide()}var that=$(this);that.sc=$('<div class="autocomplete-suggestions '+o.menuClass+'"></div>'),that.data("sc",that.sc).data("autocomplete",that.attr("autocomplete")),that.attr("autocomplete","off"),that.cache={},that.last_val="",that.updateSC=function(resize,next){if(o.css&&that.sc.css(o.css),!resize&&(that.sc.show(),that.sc.maxHeight||(that.sc.maxHeight=parseInt(that.sc.css("max-height"))),that.sc.suggestionHeight||(that.sc.suggestionHeight=$(".autocomplete-suggestion",that.sc).first().outerHeight()),that.sc.suggestionHeight))if(next){var scrTop=that.sc.scrollTop(),selTop=next.offset().top-that.sc.offset().top;selTop+that.sc.suggestionHeight-that.sc.maxHeight>0?that.sc.scrollTop(selTop+that.sc.suggestionHeight+scrTop-that.sc.maxHeight):0>selTop&&that.sc.scrollTop(selTop+scrTop)}else that.sc.scrollTop(0)},$(window).on("resize.autocomplete",that.updateSC),that.sc.appendTo(o.appendTo||"body"),that.sc.on("mouseleave",".autocomplete-suggestion",function(){$(".autocomplete-suggestion.selected").removeClass("selected")}),that.sc.on("mouseenter",".autocomplete-suggestion",function(){$(".autocomplete-suggestion.selected").removeClass("selected"),$(this).addClass("selected")}),that.sc.on("mousedown click",".autocomplete-suggestion",function(e){var item=$(this),v=item.data("val");return(v||item.hasClass("autocomplete-suggestion"))&&(that.val(v),o.onSelect(e,v,item),that.sc.hide()),!1}),that.on("blur.autocomplete",function(){try{over_sb=$(".autocomplete-suggestions:hover").length}catch(e){over_sb=0}over_sb?that.is(":focus")||setTimeout(function(){that.focus()},20):(that.last_val=that.val(),that.sc.hide(),setTimeout(function(){that.sc.hide()},350))}),o.minChars||that.on("focus.autocomplete",function(){that.last_val="\n",that.trigger("keyup.autocomplete")}),that.on("keydown.autocomplete",function(e){if((40==e.which||38==e.which)&&that.sc.html()){var next,sel=$(".autocomplete-suggestion.selected",that.sc);return sel.length?(next=40==e.which?sel.next(".autocomplete-suggestion"):sel.prev(".autocomplete-suggestion"),next.length?(sel.removeClass("selected"),that.val(next.addClass("selected").data("val"))):(sel.removeClass("selected"),that.val(that.last_val),next=0)):(next=40==e.which?$(".autocomplete-suggestion",that.sc).first():$(".autocomplete-suggestion",that.sc).last(),that.val(next.addClass("selected").data("val"))),that.updateSC(0,next),!1}if(27==e.which)that.val(that.last_val).sc.hide();else if(13==e.which||9==e.which){var sel=$(".autocomplete-suggestion.selected",that.sc);sel.length&&that.sc.is(":visible")&&(o.onSelect(e,sel.data("val"),sel),setTimeout(function(){that.sc.hide()},20))}}),that.on("keyup.autocomplete",function(e){if(!~$.inArray(e.which,[13,27,35,36,37,38,39,40])){var val=that.val();if(val.length>=o.minChars){if(val!=that.last_val){if(that.last_val=val,clearTimeout(that.timer),o.cache){if(val in that.cache)return void suggest(that.cache[val]);for(var i=1;i<val.length-o.minChars;i++){var part=val.slice(0,val.length-i);if(part in that.cache&&!that.cache[part].length)return void suggest([])}}that.timer=setTimeout(function(){o.source(val,suggest)},o.delay)}}else that.last_val=val,that.sc.hide()}})})},$.fn.autoComplete.defaults={source:0,minChars:3,delay:150,cache:1,menuClass:"",renderItem:function(item,search){search=search.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var re=new RegExp("("+search.split(" ").join("|")+")","gi");return'<div class="autocomplete-suggestion" data-val="'+item+'">'+item.replace(re,"<b>$1</b>")+"</div>"},onSelect:function(e,term,item){}}}(jQuery);